\documentclass[12pt,a4paper]{article}

% == FOR DOC AND TESTS - START == %

\usepackage[utf8]{inputenc}
\usepackage{ucs}
\usepackage[top=2cm, bottom=2cm, left=1.5cm, right=1.5cm]{geometry}

\usepackage{color}
\usepackage{hyperref}
\hypersetup{
    colorlinks,
    citecolor=black,
    filecolor=black,
    linkcolor=black,
    urlcolor=black
}

\usepackage{enumitem}

\usepackage{amsthm}

\usepackage{tcolorbox}
\tcbuselibrary{listings}

\usepackage{pgffor}
\usepackage{xstring}


% MISC

\setlength{\parindent}{0cm}
\setlist{noitemsep}

\theoremstyle{definition}
\newtheorem*{remark}{Remark}

\usepackage[raggedright]{titlesec}

\titleformat{\paragraph}[hang]{\normalfont\normalsize\bfseries}{\theparagraph}{1em}{}
\titlespacing*{\paragraph}{0pt}{3.25ex plus 1ex minus .2ex}{0.5em}


% Technical IDs

\newwrite\tempfile

\immediate\openout\tempfile=x-\jobname.macros-x.txt

\AtEndDocument{\immediate\closeout\tempfile}

\newcommand\IDconstant[1]{%
    \immediate\write\tempfile{constant@#1}%
}

\makeatletter
	\newcommand\IDmacro{\@ifstar{\@IDmacro@star}{\@IDmacro@no@star}}

    \newcommand\@IDmacro@no@star[3]{%
        \texttt{%
        	\textbackslash#1%
        	\IfStrEq{#2}{0}{}{%
        		\,\,[#2 Option%
				\IfStrEq{#2}{1}{}{s}]%
			}%
    	    \IfStrEq{#3}{}{}{%
	    		\,\,(#3 Argument%
				\IfStrEq{#3}{1}{}{s})%
			}
	   	}
        \immediate\write\tempfile{macro,#1,#2,#3}%
    }

    \newcommand\@IDmacro@star[2]{%
        \@IDmacro@no@star{#1}{0}{#2}%
    }

	\newcommand\@IDoptarg{\@ifstar{\@IDoptarg@star}{\@IDoptarg@no@star}}

	\newcommand\@IDoptarg@star[2]{%
    	\vspace{0.5em}
		--- \texttt{#1%
			\IfStrEq{#2}{}{:}{\,#2:}%
		}%
	}

	\newcommand\@IDoptarg@no@star[2]{%
    	\IfStrEq{#2}{}{%
			\@IDoptarg@star{#1}{}%
		}{%
			\@IDoptarg@star{#1}{\##2}%
		}%
	}

	\newcommand\IDkey[1]{%
    	\@IDoptarg*{Option}{{\itshape "#1"}}%
	}

	\newcommand\IDoption[1]{%
    	\@IDoptarg{Option}{#1}%
	}

	\newcommand\IDarg[1]{%
    	\@IDoptarg{Argument}{#1}%
	}
\makeatother

% == FOR DOC AND TESTS - END == %


% == EXTRAS == %

\makeatletter
    \newcommand\@interval@tool@star[4]{%
    	\ensuremath{ \left#1 \vphantom{\relsize{1.25}{\text{$\displaystyle F_1^2$}}} \right. \!\! #2 ; #3 \left. \vphantom{\relsize{1.25}{\text{$\displaystyle F_1^2$}}} \!\! \right#4}%
	}

    \newcommand\@interval@tool@no@star[4]{\ensuremath{ \left#1 #2 \, ; #3 \right#4}}
\makeatother
    
\newcommand\dd[1]{d#1}


% == PACKAGES USED == %

\usepackage{amsmath}
\usepackage{relsize}

% == DEFINITIONS == %

% Source for minimizing spaces between consecutive integrals :
%    * http://forum.mathematex.net/latex-f6/integrale-triple-t13312.html#p128016

% Consecutive integrals

\makeatletter
    \let\original@int\int
    \DeclareRobustCommand{\int}{%
        \original@int\operator@followup{\@ifnextchar{\int}{\!\!}{}}%
    }

    \def\operator@followup#1{%
        \@ifnextchar{^}{\operator@followup@sup{#1}}%
            {\operator@followup@nosup{#1}}%
    }

    \def\operator@followup@sup#1^#2{%
        \@ifnextchar{_}{\operator@followup@sup@sub{#1}^{#2}}%
            {\operator@followup@sup@nosub{#1}^{#2}}%
    }

    \def\operator@followup@sup@sub#1^#2_#3{%
        \operator@followup@{#1}{#2}{#3}%
    }

    \def\operator@followup@sup@nosub#1^#2{%
        \operator@followup@{#1}{#2}{}%
    }

    \def\operator@followup@nosup#1{%
        \@ifnextchar{_}{\operator@followup@nosup@sub{#1}}
            {\operator@followup@nosup@nosub{#1}}%
    }

    \def\operator@followup@nosup@sub#1_#2{%
        \@ifnextchar{^}{\operator@followup@nosup@sub@sup{#1}_{#2}}
            {\operator@followup@nosup@sub@nosup{#1}_{#2}}%
    }

    \def\operator@followup@nosup@sub@sup#1_#2^#3{%
        \operator@followup@{#1}{#3}{#2}%
    }

    \def\operator@followup@nosup@sub@nosup#1_#2{%
        \operator@followup@{#1}{}{#2}%
    }

    \def\operator@followup@nosup@nosub#1{%
        \operator@followup@{#1}{}{}%
    }

    \def\operator@followup@#1#2#3{%
        ^{#2}_{#3}#1%
    }

% The hook calculator
    \newcommand\hook{\@ifstar{\@hook@star}{\@hook@no@star}}
    \newcommand\@hook@star[3]{\ensuremath{ \left[ \vphantom{\relsize{1.25}{\text{$\displaystyle F_1^2$}}} \right. \!\! #1 \left. \vphantom{\relsize{1.25}{\text{$\displaystyle F_1^2$}}} \!\! \right]_{#2}^{#3} }}
    \newcommand\@hook@no@star[3]{\left[ \vphantom{\text{\relsize{1.1}$#1$}} #1 \right]_{#2}^{#3}}

    \newcommand\vhook{\@ifstar{\@vhook@star}{\@vhook@no@star}}
    \newcommand\@vhook@star[3]{#1 {\text{\relsize{1.5}$\rvert$}}_{#2}^{#3}}
    \newcommand\@vhook@no@star[3]{\left. #1 \right\rvert_{#2}^{#3}}

\makeatother



\begin{document}

% \section{Analysis}

    \subsection{Integral calculus}

        \subsubsection{The hook operator - 1st version}

            \paragraph{Example of use \#1}

\begin{tcblisting}{}
By definition, $\displaystyle \int_{a}^{b} f(x) \dd{x} = \hook{F(x)}{a}{b}$ where
$\hook{F(x)}{a}{b} = F(b) - F(a)$.
\end{tcblisting}


            \paragraph{Example of use \#2}

By default, the hooks stretch vertically, but if you don't want this you just have to use the @star version as in the example below.

\begin{tcblisting}{}
$\displaystyle \hook{\frac{x - 1}{5 + x^2}}{a}{b}
             = \hook*{\frac{x - 1}{5 + x^2}}{a}{b}$.
\end{tcblisting}


            \paragraph{Technical IDs}

\IDmacro*{hook}{3}

\IDmacro*{hook*}{3}

\IDarg{1} the content inside the hooks.

\IDarg{2} the lower bound displayed as an index.

\IDarg{3} the upper bound displayed as an exponent.



        \subsubsection{The hook operator - 2nd version}

            \paragraph{Example of use \#1}

\begin{tcblisting}{}
You can use $\vhook{F(x)}{a}{b}$ instead of $\hook{F(x)}{a}{b}$.
\end{tcblisting}


            \paragraph{Example of use \#2}

Like with first version of the hook operator, you can use a @star version to not have the default behavior of vertical stretch. Here is an example.

\begin{tcblisting}{}
$\displaystyle \vhook{\frac{x - 1}{5 + x^2}}{a}{b}
             = \vhook*{\frac{x - 1}{5 + x^2}}{a}{b}$.
\end{tcblisting}


            \paragraph{Technical IDs}

\IDmacro*{vhook}{3}

\IDmacro*{vhook*}{3}

\IDarg{1} the content before the vertical line $\vert$ .

\IDarg{2} the lower bound displayed as an index.

\IDarg{3} the upper bound displayed as an exponent.



        \subsubsection{Several integrals}

The package minimizes spacings between consecutive symbols of integration. Here is an example.

\begin{tcblisting}{}
$\displaystyle \int \int \int F(x;y;z) \dd{x} \dd{y} \dd{z}
= \int_{a}^{b} \int_{c}^{d} \int_{e}^{f} F(x;y;z) \dd{x} \dd{y} \dd{z}$
\end{tcblisting}


\begin{remark}
	By default, \LaTeX{} prints
	\makeatletter
    	$\displaystyle \original@int \original@int \original@int F(x;y;z) \dd{x} \dd{y} \dd{z}
    	= \original@int_{a}^{b} \original@int_{c}^{d} \original@int_{e}^{f} F(x;y;z) \dd{x} \dd{y} \dd{z}$.
	\makeatother
\end{remark}

\end{document}
