% == PACKAGES USED == %

\usepackage{forest}


% == DEFINITIONS == %

\useforestlibrary{linguistics}
\forestset{declare count={connections}{1}}

% Source : ????

\newcommand\@proba@tree[1]{
    \begin{forest}
        for tree={%
            sn edges,
            grow'  = 0,
            l      = 2.5cm,
            s sep  = 1.2cm,
            anchor = parent,
        },
        before typesetting nodes={%
            where connections=1{}{%
                if = {isodd(connections())}{%
                    edge path'={%
                        foreach \i [
                            count=\j from 0,
                            evaluate=\noexpand\j
                            as \noexpand\k
                            using \noexpand {
                                (\j==0) ?
                                0pt :
                                ((isodd(\j)) ?
                                (\j*4pt) :
                                ((-\j+1)*4pt))
                            }
                        ]
                        in {%
                            1, ..., \foresteoption{connections}
                        }{
                            (!u.parent anchor)
                            --
                            ([yshift=\noexpand\k].child anchor)
                        }
                    },
                }{%
                    edge path'={%
                        foreach \i [
                            count=\j,
                            evaluate=\noexpand\j
                            as \noexpand\k
                            using {
                                (isodd(\j)) ?
                                (\j*4pt) :
                                ((-\j+1)*4pt)
                            }
                        ]
                        in {1,...,\foresteoption{connections}}
                        {
                            (!u.parent anchor)
                            --
                            ([yshift=\noexpand\k].child anchor)
                        }
                    },
                },
            },
        },
        #1
    \end{forest}
}

% Source: https://stackoverflow.com/a/1873617/4589608
\newenvironment{probatree}{\startprobatree}{}
\def\startprobatree#1\end{\@proba@tree{#1}\end}

\newenvironment{probatree*}{
	\let\probaweight\probanoweight
	\begin{probatree}
}{
	\end{probatree}
}


\newcommand\probaweight[1]{node[midway, fill=white]{#1}}
\newcommand\probanoweight[1]{}

