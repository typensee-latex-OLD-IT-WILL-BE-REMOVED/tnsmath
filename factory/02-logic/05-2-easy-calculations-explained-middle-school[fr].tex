\documentclass[12pt,a4paper]{article}

\makeatletter
    \input{../config/header[fr].sty}
    \input{../01-misc/00-common-tools.sty}

    \usepackage{05-calculations-explained}
\makeatother


\newcommand\RRp{RR+}
\newcommand\vimplies{\Downarrow}
\newcommand\viff{\Updownarrow}


\begin{document}

%\section{Logique et fondements}

%\subsection{Détailler un raisonnement}

\subsubsection{Détailler un raisonnement simple -- Version pour les collégiens} \label{explain-proof-for-youngs}

L'environnement \env{aexplain}
\footnote{
    Cet environnement utilise le package \texttt{witharrows} qui est très sympathique pour expliquer des étapes de calcul.
}
utilise des flèches pour indiquer les explications
\emph{(\prefix{a} est pour \whyprefix{a}{rrow} soit \inenglish{flèche})}.
Son fonctionnement est similaire à celui de \env{explain} si ce n'est que la macro \macro{explnext*} permet d'avoir une flèche unidirectionnelle, vers le haut ou le bas au choix, ou bien d'écrire deux indications dont l'une est montante et l'autre descendante.

\medskip

Il existe aussi l'environnement \env{aexplain*} lorsque la toute 1\iere{} étape n'est pas expliquée.
Par contre ceci nécessite au tout début de l'environnement l'usage de la macro très spéciale \macro{explnext} sans aucun contenu !


% ---------------------- %


\newparaexample{Flèche à double sens ou sans flèche}

\begin{latexex}
\begin{aexplain}
    (a + b)^2
        \explnext{Identité remarquable}
    a^2 + 2 a b + b^2
        \explnext{}
    a^2 + b^2 + 2 a b
\end{aexplain}
\end{latexex}


% ---------------------- %


\newparaexample{Des flèches unidirectionnelles}

Ce qui suit est juste là comme démo. car les explications y sont un peu farfelues.

\begin{latexex-flat}
\begin{aexplain}
    (a + b)^2
        \explnext*{Via $P^2 = P \cdot P$.}
                  {Via $P \cdot P = P^2$.}
    (a + b) (a + b)
        \explnext*{Double développement.}%
                  {Double factorisation (pas simple).}
    a^2 + a b + b a + b^2
        \explnext*{Commutativité du produit.}%
                  {}
    a^2 + 2 a b + b^2
        \explnext*{}%
                  {Commutativité de l'addition.}
    a^2 + b^2 + 2 a b
\end{aexplain}
\end{latexex-flat}


% ---------------------- %


\newparaexample{Ne pas expliquer le tout début}

L'environnement étoilé \env{aexplain*} débute différemment la mise en forme.

\begin{latexex-flat}
\begin{aexplain*}
    (a + b) (a + b)
        \explnext{}
    (a + b)^2
        \explnext{Identité remarquable.}
    a^2 + b^2 + 2 a b
\end{aexplain*}
\end{latexex-flat}


% ---------------------- %


\newparaexample{Choisir son symbole}

Voici comment faire avec la version non étoilée où l'implication finale est juste là pour la démo. \emph{(on notera une petite bidouille un peu sale à faire pour avoir un alignement à peu près correct)}.

\begin{latexex}
\begin{aexplain}[\iff]
    a^2 + 2 a b + b^2 = 0
        \explnext{}
    (a + b)^2 = 0
        \explnext[\:\implies]%
                 {$P^2 = 0$ ssi $P = 0$.}
    a + b = 0
\end{aexplain}
\end{latexex}


Avec la version étoilée, on obtient ce qui suit.

\begin{latexex-flat}
\begin{aexplain*}[\iff]
    a^2 + 2 a b + b^2 = 0
        \explnext{}
    (a + b)^2 = 0
        \explnext[\:\implies]%
                 {$P^2 = 0$ ssi $P = 0$.}
    a + b = 0
\end{aexplain*}
\end{latexex-flat}


% ---------------------- %


\subsubsection{Un mini hack très utile pour des \emph{\og étapes alignées \fg}}

Vous pouvez écrire très facilement des calculs ou raisonnement simples alignés comme suit sans trop vous fatiguez \emph{(chacune des trois solutions présentées laisse toujours la possibilité de changer de symbole ainsi que d'expliquer une étape intermédiaire après coup)}.

\begin{latexex}
\begin{aexplain*}
    (a + b) (a + b)
        \explnext{}
    (a + b)^2
        \explnext{}
    a^2 + b^2 + 2 a b
        \explnext{}
    a^2 + 2 a b + b^2
\end{aexplain*}
\end{latexex}

On a accès à une autre mise en forme \emph{(ceci peut rendre aussi service)}. 

\begin{latexex}
\begin{aexplain}
    (a + b) (a + b)
        \explnext{}
    (a + b)^2
        \explnext{}
    a^2 + b^2 + 2 a b
        \explnext{}
    a^2 + 2 a b + b^2
\end{aexplain}
\end{latexex}

Enfin dans le cadre de calculs à faire expliquer par des élèves, ce qui suit peut être utile.

\begin{latexex}
\begin{explain}
    (a + b) (a + b)
        \explnext{}
    (a + b)^2
        \explnext{}
    a^2 + b^2 + 2 a b
        \explnext{}
    a^2 + 2 a b + b^2
\end{explain}
\end{latexex}


% ---------------------- %


\subsubsection{Fiches techniques}

\paragraph{Détailler un raisonnement simple} 

\IDenv{explain}{1}

\IDenv{aexplain}{1}  où \quad \mwhyprefix{a}{rrow}

\IDenv{aexplain*}{1}  où \quad \mwhyprefix{a}{rrow}

\IDoption{} le symbole à utiliser dans l'environnement, la valeur par défaut étant \verb+=+ .


\separation


\emph{\textbf{ATTENTION !} La macro \macro{explnext} est à utiliser sans argument au tout début de l'environnement \env{aexplain*}.}

\extraspace

\extraspace

\IDmacro{explnext}{1}{1} où \quad \mwhyprefix{expl}{ain}

\IDoption{} le symbole à utiliser pour une explication, la valeur par défaut étant celle du symbole de l'environnement \env{explain} où \macro{explnext} est utilisé.

\IDarg{} le texte de l'explication qui peut être vide si aucune explication n'est à afficher.


\separation


\IDmacro{explnext*}{1}{2} où \quad \mwhyprefix{expl}{ain}

\IDoption{} le symbole à utiliser pour une explication, la valeur par défaut étant celle du symbole de l'environnement \env{explain} où \macro{explnext} est utilisé.

\IDarg{1} le texte de l'explication pour la 1\iere{} ligne.
          Ce texte peut être vide \emph{(voir l'environnement \env{aexplain} pour la raison de ceci)}.

\IDarg{2} le texte de l'explication pour la 2\ieme{} ligne.
          Ce texte peut être vide \emph{(voir l'environnement \env{aexplain} pour la raison de ceci)}.


% ---------------------- %


\paragraph{Détailler un raisonnement simple -- Mise en forme du texte}

Les macros suivantes sont juste utilisées par l'environnement \env{explain}.


\separation


\IDmacro*{expltxtspacein}{0}


\separation


\IDmacro*{expltxt}{1} où \quad \mwhyprefix{expl}{ain}

\IDarg{} le texte de l'explication que l'on veut mettre en forme.


\separation


\IDmacro*{expltxtdown}{1} où \quad \mwhyprefix{expl}{ain}

\IDarg{} le texte de l'explication du haut vers le bas que l'on veut mettre en forme.


\separation


\IDmacro*{expltxtup}{1} où \quad \mwhyprefix{expl}{ain}

\IDarg{} le texte de l'explication du bas vers le haut que l'on veut mettre en forme.


\end{document}
