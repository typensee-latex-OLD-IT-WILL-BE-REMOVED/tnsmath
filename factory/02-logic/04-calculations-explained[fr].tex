\documentclass[12pt,a4paper]{article}

\makeatletter
    \input{../config/header[fr].sty}
    \input{../01-misc/00-common-tools.sty}

    \usepackage{04-calculations-explained}
\makeatother


\newcommand\RRp{RR+}
\newcommand\vimplies{\Downarrow}
\newcommand\viff{\Updownarrow}


\begin{document}

%\section{Logique et fondements}

\subsection{Détailler un raisonnement} \label{explain-proof}

\paragraph{Exemple 1 -- Avec les réglages par défaut}

L'environnement \env{explain} permet de détailler les étapes principales d'un calcul ou d'un raisonnement en s'appuyant sur la macro \macro{explnext} dont le nom vient de \emph{\og \textbf{expl}-ain \textbf{next} step \fg} soit \emph{\og expliquer la prochaine étape \fg}
\footnote{
    Le gros du travail est fait par l'environnement \env{flalign} du package \texttt{amsmath} qui est automatiquement chargé par \texttt{lymath}.
}.
Voici un exemple avec les réglages par défaut \emph{(notez les espaces verticaux ajoutés automatiquement avant et après)}.

\begin{latexex-flat}
\begin{explain}
    (a + b)^2
        \explnext{On utilise $x^2 = x \cdot x$.}
    (a + b) (a + b)
        \explnext{Double développement depuis la parenthèse gauche.}
    a^2 + a b + b a + b^2
        \explnext{Commutativité du produit.}
    a^2 + 2 a b + b^2
\end{explain}
\end{latexex-flat}


\begin{remark}
    La macro \macro{explnext} utilise les macros constantes suivantes.
    \begin{itemize}
        \item \macro{textexplainleft} et \macro{textexplainright} qui donnent $\textexplainleft$ et $\textexplainright$ respectivement par défaut.

        \item \macro{textexplainspacein} est l'espacement entre le symbole et la courte explication. Par défaut, cette macro vaut \verb+2em+.
    \end{itemize}
\end{remark}


% ---------------------- %


\paragraph{Exemple 2 -- Utiliser un autre symbole globalement}

L'environnement \env{explain} possède un argument optionnel qui est \verb+=+ par défaut. Ceci permet de faire ce qui suit sans effort.

\begin{latexex}
\begin{explain}[\viff]
    x^2 + 10 x + 25 = 0
        \explnext{Identité remarquable.}
    (x + 5)^2 = 0
        \explnext{$X^2 = 0$ si et 
                  seulement si $X = 0$.}
    x = -5
\end{explain}
\end{latexex}


% ---------------------- %


\paragraph{Exemple 3 -- Juste utiliser des symboles}

Si l'argument obligatoire de la macro \macro{explnext} est vide alors seul le symbole est affiché. Voici un court exemple de ceci.

\begin{latexex}
\begin{explain}[\viff]
    a^2 = b^2
        \explnext{}
    a = \pm b
\end{explain}
\end{latexex}


%% ---------------------- %


\paragraph{Exemple 4 -- Utiliser un autre symbole localement}

La macro \macro{explnext} possède un argument optionnel qui utilise par défaut celui de l'environment. En utilisant cette option, on choisit alors localement le symbole à employer. Voici un exemple farfelu d'utilisation.

\begin{latexex}
\begin{explain}[\viff]
    0 \leq a < b
        \explnext[\vimplies]%
                 {Croissance de $x^2$ 
                  sur $\RRp$.}
    a^2 < b^2
        \explnext{}
    a^2 - b^2 < 0
        \explnext{Identité remarquable.}
    (a - b)(a + b) < 0
        \explnext[\vimplies]{}
    a \neq b
\end{explain}
\end{latexex}


% ---------------------- %


\subsubsection{Fiches techniques}

\paragraph{Les textes pour détailler un raisonnement}

\IDmacro*{textexplainleft}{0}

\IDmacro*{textexplainright}{0}

\IDmacro*{textexplainspacein}{0}


% ---------------------- %


\paragraph{Détailler un raisonnement}

\IDenv{explain}{1}

\IDoption{} le symbole à utiliser dans l'environnement, la valeur par défaut étant \verb+=+ .


\separation


\IDmacro{explnext}{1}{1}

\IDoption{} le symbole à utiliser pour une explication, la valeur par défaut étant celle du symbole de l'environnement \env{explain} où \macro{explnext} est utilisé.

\IDarg{} le texte de l'explication qui peut être vide si aucune explication n'est à afficher.


\end{document}
