\documentclass[12pt,a4paper]{article}

\makeatletter
    \input{../config/header[fr].sty}

    \usepackage{07-tables}
\makeatother


\usepackage{amsmath}


\newcommand\ee{e}


\begin{document}

% \section{Analysis}

\subsection{Tableaux de variation et de signe}

\subsubsection{Les bases}

\paragraph{Comment ça marche ?}

Tout le boulot est fait par le package \verb+tkz-tab+ auquel on impose le choix d'une pointe de flèche plus visible via le réglage suivant \verb+\tkzTabSetup[arrowstyle = triangle 60]+.

\medskip

Nous donnons quelques exemples classiques d'utilisation proches ou identiques de certains proposés dans la documentation de \verb+tkz-tab+ \emph{(les codes ont été mis en forme pour faciliter la compréhension de la syntaxe à suivre)}.
Reportez vous à la documentation de \verb+tkz-tab+ pour des compléments d'information : vous y trouverez des réglages très fins.


% ---------------------- %


\newparaexample{Avec des signes}

\begin{latexex-flat}
\begin{tikzpicture}
    \tkzTabInit{
        $x$       / 0.75 , % Facteur d'échelle de 0.75 pour la hauteur de la 1er ligne.
        $\cos(x)$ / 1      % Facteur d'échelle de  1   pour la hauteur de la 2e ligne.
    }{
                $0$     , $\frac{\pi}{2}$     , $\pi$  % Valeurs utiles de x.
    }
    \tkzTabLine{    , + , z               , - ,      } % Signes et zéro.
\end{tikzpicture}
\end{latexex-flat}


% ---------------------- %


\newparaexample{Avec des variations (sans cadre)}

\begin{latexex-flat}
\begin{tikzpicture}
    \tkzTabInit[nocadre]{
        $x$    / 0.75 ,
        $f(x)$ / 1.5
    }{
               $-\infty$ , $p$        , $+\infty$
    }
    \tkzTabVar{+ /       , - / $f(p)$ , + /      } % Variations via position / valeur.
\end{tikzpicture}
\end{latexex-flat}


% ---------------------- %


\newparaexample{Variations via une dérivée (sans cadre)}

\begin{latexex-flat}
\begin{tikzpicture}
    \tkzTabInit[nocadre]{
        $x$       / 0.75 ,
        $\cos(x)$ / 1    ,
        $\sin(x)$ / 1.5
    }{
                $0$     , $\frac{\pi}{2}$     , $\pi$
    }
    \tkzTabLine{    , + , z               , - ,      }
    \tkzTabVar {- / 0   , + / 1               , - / 0}
\end{tikzpicture}
\end{latexex-flat}


% ---------------------- %


\newparaexample{Une image intermédiaire avec une seule flèche}

\begin{latexex-flat}
\begin{tikzpicture}
    \tkzTabInit{
        $x$     / 0.75 ,
        $3 x^2$ / 1    ,
        $x^3$   / 1.5
    }{
                $-\infty$         , $0$     , $+\infty$
    }
    \tkzTabLine{              , + , 0   , + ,              }
    \tkzTabVar {- / $-\infty$     , R       , + / $+\infty$}
    %
    \tkzTabIma{1}{3}{2} % Position entre les 1re et 3e valeurs puis rang relatif.
              {$0$}     % Valeur de l'image.
\end{tikzpicture}
\end{latexex-flat}


% ---------------------- %


\newparaexample{Valeurs interdites et valeurs supplémentaires}

\begin{latexex-flat}
\begin{tikzpicture}
    \tkzTabInit[espcl = 6]{    % Largeur entre les valeurs du tableau.
        $x$            / 0.75 ,
        $\dfrac{1}{x}$ / 1.25 ,
        $\ln$          / 1.75
    }{
                $0$                , $+\infty$
    }
    \tkzTabLine{d              , + ,              }
    \tkzTabVar {D- / $-\infty$     , + / $+\infty$}
    %
    \tkzTabVal{1}{2}{0.35} % Position entre les 1re et 2e valeurs puis en proportion.
              {1}{0}       % x_1 et f(x_1)
    \tkzTabVal{1}{2}{0.65} % Position entre les 1re et 2e valeurs puis en proportion.
              {$\ee$}{1}   % x_2 et f(x_2)
\end{tikzpicture}
\end{latexex-flat}

Voici un autre exemple pour comprendre comment utiliser \macro{tkzTabVal} avec en plus l'option \verb+draw+ qui peut rendre service.

\begin{latexex-flat}
\begin{tikzpicture}
    \tkzTabInit[espcl = 4]{
        $x$     / 0.75 ,
        $f'(x)$ / 1    ,
        $f(x)$  / 1.5
    }{
                $0$                , $\ee$         , $+\infty$
    }
    \tkzTabLine{d              , + , 0         , - ,          }
    \tkzTabVar {D- / $-\infty$     , + / $\ee$     , - / $0$  }
    %
    \tkzTabVal[draw]{1}{2}{0.5} % Position entre les 1re et 2e valeurs au milieu.
                    {$1$}{$\frac{1}{\ee}$}
    \tkzTabVal[draw]{2}{3}{0.5} % Position entre les 2e et 3e valeurs au milieu.
                    {$\ee^2$}{$1$}
\end{tikzpicture}
\end{latexex-flat}


% ---------------------- %


\newparaexample{Signe à partir des variations (un peu de pédagogie...)}

Il est assez facile de produire des choses très utiles pédagogiquement comme ce qui suit en se salissant un peu les mains avec du code TikZ.

\begin{center}
\begin{tikzpicture}
    \tkzTabInit[espcl = 4]{
        $x$    / 0.75 ,
        $f(x)$ / 1.5
    }{
               $-\infty$ , $-1$     , $2$ , $+\infty$
    }
    \tkzTabVar{- /       , + / $-9$ , - / , + /      }
    %
    \tkzTabVal[draw]{3}{4}{0.5} % Position entre les 3e et 4e valeurs au milieu.
              {$3$}{$0$}
\end{tikzpicture}
\end{center}

On en déduit le signe de la fonction $f$.

\begin{center}
\begin{tikzpicture}
    \tkzTabInit[
        espcl = 4,
%        help       % <-- Pour voir les noms des noeuds.
    ]{
        $x$    / 0.75 ,
        $f(x)$ / 1
    }{
        $-\infty$ , , , $+\infty$ % ATTENTION ! Ne pas oublier de virgules.
    }
    %
    \node at ($(N31)!0.5!(N40)$){$3$};
    \node at ($(M31)!0.5!(M32)$){$0$};
    \node at ($(M31)!0.5!(N42)$){$+$};
    \node at ($(N11)!0.5!(M32)$){$-$};
\end{tikzpicture}
\end{center}


Voici le code du 1\ier{} tableau où le placement de la valeur $3$ au milieu entre $2$ et $+\infty$ va nous simplifier le travail pour le 2\ieme{} tableau.

\medskip

\begin{latexex-alone}
\begin{tikzpicture}
    \tkzTabInit[espcl = 4]{
        $x$    / 0.75 ,
        $f(x)$ / 1.5
    }{
               $-\infty$ , $-1$     , $2$ , $+\infty$
    }
    \tkzTabVar{- /       , + / $-9$ , - / , + /      }
    %
    \tkzTabVal[draw]{3}{4}{0.5} % Position entre les 3e et 4e valeurs au milieu.
              {$3$}{$0$}
\end{tikzpicture}
\end{latexex-alone}


Pour produire lee code du 2\ieme{} tableau, il a été utilisé au préalable ce qui suit en activant l'option \verb@help@ qui demande à \verb@tkz-tab@ d'afficher les noms de noeuds au sens TikZ qui ont été créés.
Ceci permet alors d'utiliser ces noeuds pour des dessins TikZ faits maison
\footnote{
    C'est grâce à ce mécanisme que \prefix{lymath} peut proposer des outils explicatifs des tableaux de signe : voir la section suivante.
}.
	
\medskip

\begin{latexex-flat}
\begin{tikzpicture}
    \tkzTabInit[
        espcl = 4,
        help       % <-- Pour voir les noms des noeuds.
    ]{
        $x$    / 0.75 ,
        $f(x)$ / 1
    }{
       $-\infty$ , $-1$ , $2$ , $+\infty$
    }
\end{tikzpicture}
\end{latexex-flat}


Maintenant que ls noms des noeuds sont connus, il devient facile de produire le code ci-après.
Bien noter l'usage de valeurs utiles \og vides \fg{} de $x$ ainsi que les mystiques \verb@\node at ($(A)!0.5!(B)$)@ permettant de placer un noeud au milieu entre les deux noeuds \verb@A@ et \verb@B@. 

\medskip

\begin{latexex-alone}
\begin{tikzpicture}
    \tkzTabInit[
        espcl = 4,
%        help       % <-- Pour voir les noms des noeuds.
    ]{
        $x$    / 0.75 ,
        $f(x)$ / 1
    }{
        $-\infty$ , , , $+\infty$ % ATTENTION ! Ne pas oublier de virgules.
    }
    %
    \node at ($(N31)!0.5!(N40)$){$3$};
    \node at ($(M31)!0.5!(M32)$){$0$};
    \node at ($(M31)!0.5!(N42)$){$+$};
    \node at ($(N11)!0.5!(M32)$){$-$};
\end{tikzpicture}
\end{latexex-alone}


% ---------------------- %


\newparaexample{Convexité et concavité symbolisées dans les variations}

Voici un autre exemple s'utilisant la machinerie TikZ afin d'indiquer dans les variations la convexité et la concavité via des flèches incurvées \emph{(cette convention est proposée dans la sous-section \emph{\og Exemple utilisant l'option \macro{help} \fg} de la section \emph{\og Gallerie \fg}  de la documentation de \prefix{tkz-tab})}.

\begin{center}
\begin{tikzpicture}
    \tkzTabInit[
        espcl = 3,
%        help       % <-- Pour voir les noms des noeuds.
    ]{
        $x$   / 0.75 ,
        $f''$ / 1    ,
        $f'$  / 2    ,
        $f$   / 3
    }{
                $-\infty$          , $0$          , $+\infty$
    }
    \tkzTabLine{               , - , z        , + ,              }
    \tkzTabVar {+ / $+\infty$      , - / $-2$     , + / $+\infty$}

    \tkzTabVal[draw]{1}{2}{.5}{$x_1$}{$0$}
    \tkzTabVal[draw]{2}{3}{.5}{$x_2$}{$0$}

    \begin{scope}[->, > = triangle 60]
        \coordinate (Middle1) at ($(N13)!0.5!(N14)$);
        \coordinate (Middle2) at ($(N23)!0.5!(N24)$);
        \coordinate (Middle3) at ($(N33)!0.5!(N34)$);
        \path (N13) -- (N23) node[midway,below=6pt](N){};
        %
        \draw ([above=6pt]Middle1)
              to [bend left=45] ([left=1pt]N);
        \draw ([right=3pt]N)
              to [bend left=45] ([above=6pt]Middle2) ;
        \draw ([below right=3pt]Middle2)
              to [bend left=-45] ([above=6pt]M24) ;
        \draw ([above right=6pt]M24)
              to [bend right=40] ([below left=6pt]Middle3);
    \end{scope}
\end{tikzpicture}
\end{center}

Le code utilisé est le suivant.

\begin{latexex-alone}
\begin{tikzpicture}
    \tkzTabInit[
        espcl = 3,
%        help       % <-- Pour voir les noms des noeuds.
    ]{
        $x$   / 0.75 ,
        $f''$ / 1    ,
        $f'$  / 2    ,
        $f$   / 3
    }{
                $-\infty$          , $0$          , $+\infty$
    }
    \tkzTabLine{               , - , z        , + ,              }
    \tkzTabVar {+ / $+\infty$      , - / $-2$     , + / $+\infty$}

    \tkzTabVal[draw]{1}{2}{.5}{$x_1$}{$0$}
    \tkzTabVal[draw]{2}{3}{.5}{$x_2$}{$0$}

    \begin{scope}[->, > = triangle 60]
        \coordinate (Middle1) at ($(N13)!0.5!(N14)$);
        \coordinate (Middle2) at ($(N23)!0.5!(N24)$);
        \coordinate (Middle3) at ($(N33)!0.5!(N34)$);
        \path (N13) -- (N23) node[midway,below=6pt](N){};
        %
        \draw ([above=6pt]Middle1)
              to [bend left=45] ([left=1pt]N);
        \draw ([right=3pt]N)
              to [bend left=45] ([above=6pt]Middle2) ;
        \draw ([below right=3pt]Middle2)
              to [bend left=-45] ([above=6pt]M24) ;
        \draw ([above right=6pt]M24)
              to [bend right=40] ([below left=6pt]Middle3);
    \end{scope}
\end{tikzpicture}
\end{latexex-alone}

\end{document}
