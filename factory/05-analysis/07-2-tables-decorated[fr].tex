\documentclass[12pt,a4paper]{article}

\makeatletter
    \input{../config/header[fr].sty}

    \usepackage{07-tables}
\makeatother

\usepackage{amsmath}


\newcommand\ee{e}
\newcommand\RR{RR}


\begin{document}

%% \section{Analysis}
%
%\subsection{Tableaux de variation et de signe}

\subsubsection{Décorer facilement un tableau}

\paragraph{Motivation}

Considérons le tableau suivant et imaginons que nous voulions l'expliquer à un débutant.

\begin{center}
\begin{tikzpicture}
    \tkzTabInit[
        lgt   = 3.5,  % Il faut de la place pour le dernier produit !
        espcl = 2.5   % On réduit la largeur des colonnes pour les signes.
    ]{
        $x$                             / 0.75 ,
        Signe de \\ $2 x - 3$           / 1.5  ,
        Signe de \\ $-x + 5$            / 1.5  ,
        Signe de \\ $(2 x - 3)(-x + 5)$ / 1.5
    }{
                $-\infty$     , $\frac{3}{2}$     , $5$     , $+\infty$
    }
    \tkzTabLine{          , - , z              , + , t   , + ,          }
    \tkzTabLine{          , + , t              , + , z   , - ,          }
    \tkzTabLine{          , - , z              , + , z   , - ,          }
\end{tikzpicture}
\end{center}

Deux options s'offrent à nous pour justifier comment a été rempli le tableau.

\begin{enumerate}
    \item Classiquement on résout par exemple juste les deux inéquations $2 x - 3 > 0$ et $-x + 5 > 0$ puis on complète les deux premières lignes
    \footnote{
        Notons que cette approche est un peu scandaleuse car il faudrait en toute rigueur aussi résoudre
        $2 x - 3 < 0$ , $-x + 5 < 0$ , $2 x - 3 = 0$ et $-x + 5 = 0$.
        Personne ne le fait car l'on pense aux variations d'une fonction affine. Dans ce cas pourquoi ne pas juste utiliser ce dernier argument?
        C'est ce que propose la 2\ieme{} méthode.
    }
    pour en déduire la dernière via la règle des signes d'un produit.

    \item On peut proposer une méthode moins sujette à la critique qui s'appuie sur la représentation graphique d'une fonction affine en produisant le tableau suivant.
\end{enumerate}

\begin{center}
\begin{tikzpicture}
    \tkzTabInit[
        lgt   = 3.5,  % Il faut de la place pour le dernier produit !
        espcl = 2.5   % On réduit la largeur des colonnes pour les signes.
    ]{
        $x$                             / 0.75 ,
        Signe de \\ $2 x - 3$           / 1.5  ,
        Signe de \\ $-x + 5$            / 1.5  ,
        Signe de \\ $(2 x - 3)(-x + 5)$ / 1.5
    }{
                $-\infty$     , $\frac{3}{2}$     , $5$     , $+\infty$
    }
    \tkzTabLine{          , - , z              , + , t   , + ,          }
    \tkzTabLine{          , + , t              , + , z   , - ,          }
    \tkzTabLine{          , - , z              , + , z   , - ,          }

    \comLine[gray]{0}{$\leftarrow$ Valeurs utiles de $x$}

    \graphSign{1}{ax+b, ap}{$\frac{3}{2}$}
    \graphSign{2}{ax+b, an}{$5$}

    \comLine[gray]{3}{$\leftarrow$ Signe d'un produit.}
\end{tikzpicture}
\end{center}


Pour produire le 2\ieme{} tableau, en plus du code \verb#tkz-tab# pour le tableau de signe qui utilise les réglages optionnels \verb#lgt = 3.5# et 
\verb#espcl = 2.5# de \macro{tkzTabInit}
\footnote{
	Ceci permet d'avoir de la place dans la 1\iere{} colonne pour le dernier produit et de réduire la largeur des colonnes pour les signes.
},
il a fallu ajouter les lignes données ci-dessous où sont utilisées les macros \macro{graphSign} et \macro{comLine} proposées par \verb+lymath+ \emph{(la syntaxe simple à suivre sera expliquée dans la section suivante)}.

\medskip

\begin{latexex-alone}
\begin{tikzpicture}
    % ---------------------------------------------------- %
    % -- Code tkz-tab pour les signes non reproduit ici -- %
    % ---------------------------------------------------- %
    \comLine[gray]{0}{$\leftarrow$ Valeurs utiles de $x$}

    \graphSign{1}{ax+b, ap}{$\frac{3}{2}$}
    \graphSign{2}{ax+b, an}{$5$}

    \comLine[gray]{3}{$\leftarrow$ Signe d'un produit.}
\end{tikzpicture}
\end{latexex-alone}


\begin{remark}
	Les lignes pour les signes doivent utiliser un coefficient minimal de \verb#1.5# pour la hauteur afin d'éviter que la superposition des graphiques. 
\end{remark}


% ---------------------- %


\paragraph{Commenter une ligne}

L'ajout de commentaires courts se fait via la macro \macro{comLine} pour \whyprefix{com}{ment a line} soit \inenglish{commenter une ligne}
\footnote{
    L'auteur de \prefix{lymath} n'est absolument pas un fan de la casse en bosses de chameau mais par souci de cohérence avec ce que propose \prefix{tkz-tab}, le nom \macro{comLine} a été proposé à la place de \macro{comline}.
}.
Cette macro possède un argument optionnel et deux obligatoires.

\begin{enumerate}
    \item \textbf{\emph{L'argument optionnel : choix de la couleur du texte.}}
          
          \smallskip
          
          Ci-dessus, nous avons utilisé \verb#\comLine[gray]{0}{...}# pour avoir un texte en gris.


    \medskip
    \item \textbf{\emph{Le 1\ier{} argument : numéro de ligne.}}
          
          \smallskip
          
          Par convention $0$ est le numéro de la toute 1\iere{} ligne contenant les valeurs utiles de la variable.
          \verb#\comLine{3}{...}# correspond donc à la 3\ieme{} ligne de signes ou moins intuitivement à la (3+1)\ieme{} ligne pour un humain non codeur.

    \medskip
    \item \textbf{\emph{Le 2\ieme{} argument : texte du commentaire.}}
          
          \smallskip
          
          Par défaut aucun retour à la ligne n'est possible.
          Si besoin se reporter à la  page \pageref{grapgsign-com-two-lines} où est montré comment écrire sur plusieurs lignes \emph{(voir le tout dernier exemple de cette section)}.
\end{enumerate}


% ---------------------- %


\paragraph{Graphiques pour expliquer des signes}

Pour le moment, la macro \macro{graphSign} propose deux types de graphiques
\footnote{
    Le choix de la casse en bosses de chameau a été expliqué pour la macro \macro{comLine}.
}.
Rappelons au passage que la convention est de prendre $0$ pour numéro de la toute 1\iere{} ligne contenant les valeurs utiles de la variable.

\begin{enumerate}
    \item \textbf{Fonctions affines non constantes.}
          
          \smallskip

          Pour les fonctions du type $f(x) = a x + b$ avec $a \neq 0$, nous devons connaître le signe de $a$ et la racine $r$ de $f$.
          
          \smallskip

          Le codage est assez simple.
          Par exemple, \verb#\graphSign{2}{ax+b, an}{$5$}# indique pour la 2\ieme{} ligne d'ajouter le graphique d'une fonction affine, ce qu'indique le code \verb#ax+b# sans espace, avec la condition $a < 0$ via \prefix{an} pour \prefix{a négatif}, et enfin avec $5$ pour racine.
          
          \smallskip

          Donc si l'on veut ajouter pour la 4\ieme{} ligne de signe le graphique de $f(x) = 3x$, on utilisera dans ce cas \verb#\graphSign{4}{ax+b, ap}{$0$}# où \prefix{ap} pour \prefix{a positif} code la condition $a > 0$.


    % ==================== %


    \medskip
    \item \textbf{Fonctions trinômiales du 2\ieme{} degré.}
          
          \smallskip

          Pour les fonctions du type $f(x) = a x^2 + b x + c$ avec $a \neq 0$, nous devons connaître le signe de $a$, celui du discriminant $\Delta = b^2 - 4ac$, ce dernier pouvant être nul, et les racines réelles éventuelles du trinôme $f$.

          \smallskip

          Voici comment coder ceci.
          Par exemple \verb#\graphSign{5}{ax2+bx+c, an, dp}{$r_1$}{$r_2$}# indique d'ajouter dans la 5\ieme{} ligne de signe le graphique d'un trinôme du 2\ieme{} degré via le code \verb#ax2+bx+c# sans espace, avec les conditions $a < 0$ et $\Delta > 0$ via \prefix{an} et \prefix{dp}, le trinôme ayant $r_1$ et $r_2$ pour racines réelles.

          \smallskip

          En plus de \prefix{dn} et \prefix{dp}, il y a \prefix{dz} pour \prefix{discriminant zéro}.
          Ainsi pour indiquer dans la 3\ieme{} ligne de signe la courbe relative à $f(x) = - 4 x^2$, on utilisera \verb#\graphSign{3}{ax2+bx+c, an, dz}{$0$}#.

          \smallskip

          Enfin le graphique associé au trinôme $f(x) = 7 x^2 + 3$, qui est sans racine réelle, s'obtiendra dans la 4\ieme{} ligne de signe via \verb#\graphSign{4}{ax2+bx+c, ap, dn}#.
\end{enumerate}


% ---------------------- %


\newparaexample{Un exemple avec une parabole}

Il devient très facile de proposer un tableau décoré comme le suivant.

\begin{center}
\begin{tikzpicture}
    \tkzTabInit[
        lgt   = 3   , % Il faut de la place pour le dernier produit !
        espcl = 1.5
    ]{
        $x$                        / 0.75 ,
        Signe de \\ $-x+3$         / 1.5  ,
        Signe de \\ $f(x)$         / 1.5  ,
        Signe de \\ $x^2 + 3x - 4$ / 1.5  ,
        Signe de \\ $-x^2 + x - 4$ / 1.5  ,
        Signe du \\ produit        / 1.5
    }{%
                $-\infty$     , $-4$     , $1$     , $3$ , $+\infty$
    }

    \tkzTabLine{          , + , t    , + , t   , + , z   , -        }
    \tkzTabLine{          , - , z    , + , z   , + , z   , -        }
    \tkzTabLine{          , - , z    , + , z   , - , t   , -        }
    \tkzTabLine{          , - , t    , - , t   , - , t   , -        }

    \tkzTabLine{          , - , z    , - , z   , + , z   , +        }

    \comLine[gray]{0}{\kern1.75em Schémas}
    
    \graphSign{1}{ax+b, an}{$3$}
    \comLine  {2}{Voir Q.1-a)}
    \graphSign{3}{ax2+bx+c, ap, dp}{$-4$}{$1$} % Deux racines réelles.
    \graphSign{4}{ax2+bx+c, an, dn}            % Aucune racine réelle.

    \comLine[gray]{5}{$\leftarrow$ Conclusion}
\end{tikzpicture}
\end{center}


En plus des deux exemples de schémas de paraboles, il faut noter dans le code supplémentaire ajouté l'utilisation de \verb#\kern1.75em# dans \verb#\comLine[gray]{0}{\kern1.75em Schémas}# afin de mettre un espace horizontal précis pour centrer à la main le texte \emph{\og Schémas \fg}.

\medskip

\begin{latexex-alone}
\begin{tikzpicture}
    % ---------------------------------------------------- %
    % -- Code tkz-tab pour les signes non reproduit ici -- %
    % ---------------------------------------------------- %
    \comLine[gray]{0}{\kern1.75em Schémas}
    
    \graphSign{1}{ax+b, an}{$3$}
    \comLine  {2}{Voir Q.1-a)}
    \graphSign{3}{ax2+bx+c, ap, dp}{$-4$}{$1$} % Deux racines réelles.
    \graphSign{4}{ax2+bx+c, an, dn}            % Aucune racine réelle.

    \comLine[gray]{5}{$\leftarrow$ Conclusion}
\end{tikzpicture}
\end{latexex-alone}


% ---------------------- %


\newparaexample{Commenter des variations} \label{grapgsign-com-two-lines}

Pour finir, indiquons que les outils de décoration marchent aussi pour les tableaux de variation.
Voici un exemple possible d'utilisation où le retour à la ligne a été obtenue affreusement, ou pas, via \verb#\parbox{11.5em}{Les limites sont hors programme pour cette année.}#.

\begin{center}
\begin{tikzpicture}
    \tkzTabInit[espcl = 3]{
        $x$     / 0.75 ,
        $f'(x)$ / 1    ,
        $f(x)$  / 1.5
    }{
                $0$                , $\ee$         , $+\infty$
    }
    \tkzTabLine{d              , + , 0         , - ,          }
    \tkzTabVar {D- / $-\infty$     , + / $\ee$     , - / $0$  }
    %

    \comLine{2}{%
    	\parbox{11.5em}{Les limites sont hors programme pour cette année.}%
	}
\end{tikzpicture}
\end{center}


% ---------------------- %


\subsubsection{Fiche technique}

\paragraph{Tableaux de signes -- Commentaires et graphiques explicatifs}

\IDmacro{comLine}{1}{2}  où \quad \mwhyprefix{com}{ment}


\IDoption{} couleur au format TikZ.


\IDarg{1} le numéro de ligne où placer le commentaire, $0$ étant le 1\ier{} numéro.

\IDarg{2} le texte du commentaire.


\separation


\IDmacro{graphSign}{1}{2..4}


\IDoption{} couleur au format TikZ.


\IDarg{1} le numéro de ligne où placer le graphique, $0$ étant le 1\ier{} numéro.


\IDarg{2} le type de fonctions avec des contraintes en utilisant la virgule comme séparateur d'informations.

\begin{enumerate}
	\item \verb@ax+b@ sans espace indique une fonction affine avec un unique paramètre \verb@a@ non nul à caractériser.

	\item \verb@ax2+bx+c@ sans espace indique une fonction trinôme du 2\ieme{} degré avec une paramètre \verb@a@ non nul à caractériser ainsi que \verb@d@ pour son discriminant.

    % ==================== %

	\smallskip
	
	\item \verb@ap@ et \verb@an@ indiquent respectivement les conditions $a > 0$ et $a < 0$.

	\item \verb@dp@, \verb@dz@ et \verb@dn@ indiquent respectivement les conditions $d > 0$, $d = 0$ et $d < 0$.
\end{enumerate}


\IDarg{supplémentaire pour ax+b} la racine de $ax + b$.


\IDarg{\!s supplémentaires pour ax2+bx+c} si $ax^2 + bx + c$ admet une ou deux racines, on donnera toutes les racines de la plus petite à la plus grande
\footnote{
	Notant $\Delta = b^2 - 4 ac$, si $\Delta < 0$ il n'y aura pas d'argument supplémentaire, si $\Delta = 0$ il y en aura un seul et enfin si $\Delta > 0$ il faudra en donner deux, le 1\ier{} étant le plus petit.
}.

\end{document}
