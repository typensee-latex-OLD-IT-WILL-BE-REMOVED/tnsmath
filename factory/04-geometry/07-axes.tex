\documentclass[12pt,a4paper]{article}

% == FOR DOC AND TESTS - START == %

\usepackage[utf8]{inputenc}
\usepackage{ucs}
\usepackage[top=2cm, bottom=2cm, left=1.5cm, right=1.5cm]{geometry}

\usepackage{color}
\usepackage{hyperref}
\hypersetup{
    colorlinks,
    citecolor=black,
    filecolor=black,
    linkcolor=black,
    urlcolor=black
}

\usepackage{enumitem}

\usepackage{amsthm}

\usepackage{tcolorbox}
\tcbuselibrary{listings}

\usepackage{pgffor}
\usepackage{xstring}

\usepackage{varioref}


% MISC

\setlength{\parindent}{0cm}
\setlist{noitemsep}

\theoremstyle{definition}
\newtheorem*{remark}{Remark}

\usepackage[raggedright]{titlesec}

\titleformat{\paragraph}[hang]{\normalfont\normalsize\bfseries}{\theparagraph}{1em}{}
\titlespacing*{\paragraph}{0pt}{3.25ex plus 1ex minus .2ex}{0.5em}


% Technical IDs

\newwrite\tempfile

\immediate\openout\tempfile=x-\jobname.macros-x.txt

\AtEndDocument{\immediate\closeout\tempfile}

\newcommand\IDconstant[1]{%
    \immediate\write\tempfile{constant@#1}%
}

\makeatletter
	\newcommand\IDmacro{\@ifstar{\@IDmacro@star}{\@IDmacro@no@star}}

    \newcommand\@IDmacro@no@star[3]{%
        \texttt{%
        	\textbackslash#1%
        	\IfStrEq{#2}{0}{}{%
        		\,\,[#2 Option%
				\IfStrEq{#2}{1}{}{s}]%
			}%
    	    \IfStrEq{#3}{}{}{%
	    		\,\,(#3 Argument%
				\IfStrEq{#3}{1}{}{s})%
			}
	   	}
        \immediate\write\tempfile{macro,#1,#2,#3}%
    }

    \newcommand\@IDmacro@star[2]{%
        \@IDmacro@no@star{#1}{0}{#2}%
    }

	\newcommand\@IDoptarg{\@ifstar{\@IDoptarg@star}{\@IDoptarg@no@star}}

	\newcommand\@IDoptarg@star[2]{%
    	\vspace{0.5em}
		--- \texttt{#1%
			\IfStrEq{#2}{}{:}{\,#2:}%
		}%
	}

	\newcommand\@IDoptarg@no@star[2]{%
    	\IfStrEq{#2}{}{%
			\@IDoptarg@star{#1}{}%
		}{%
			\@IDoptarg@star{#1}{\##2}%
		}%
	}

	\newcommand\IDkey[1]{%
    	\@IDoptarg*{Option}{{\itshape "#1"}}%
	}

	\newcommand\IDoption[1]{%
    	\@IDoptarg{Option}{#1}%
	}

	\newcommand\IDarg[1]{%
    	\@IDoptarg{Argument}{#1}%
	}
\makeatother

% == FOR DOC AND TESTS - END == %


% == EXTRA == %

\usepackage[f]{esvect}
\usepackage{relsize}
\usepackage{yhmath}
\usepackage{xstring}


\makeatletter
    \newcommand\@interval@tool@star[5]{%
    	\ensuremath{ \left#1 \vphantom{\relsize{1.25}{\text{$\displaystyle F_1^2$}}} \right. \!\! #2 #3 #4 \left. \vphantom{\relsize{1.25}{\text{$\displaystyle F_1^2$}}} \!\! \right#5}%
	}

    \newcommand\@interval@tool@no@star[5]{\ensuremath{ \left#1 #2 #3 #4 \right#5}}
    
    \newcommand\gpt[1]{\mathrm{#1}}


	\newcommand\@no@point[1]{%
		\IfStrEq{#1}{i}{%
			\imath%
		}{%
			\IfStrEq{#1}{j}{%
				\jmath%
			}{%
				#1
			}%
		}%
	}
	
	\newcommand\vect{\@ifstar{\@vect@star}{\@vect@no@star}}
	\newcommand*\@vect@star[1]{\vv*{\@no@point{#1}}}
	\newcommand*\@vect@no@star[1]{\vv{\@no@point{#1}}}
\makeatother


% == PACKAGES USED == %

\usepackage{ifmtarg}
\usepackage{trimspaces}


% == DEFINITIONS == %

% Sources : see the sources of the macros for continued fractions. 

\makeatletter
% General naming of axis
	\def\@axis@comafy@#1//#2\@nil{%
		\@ifmtarg{#2}{%
			#1%
		}{%
			#1 , \@axis@comafy@#2\@nil%
		}%
	}

	\newcommand\axis{\@ifstar{\@axis@star}{\@axis@no@star}}

    \newcommand\@axis@no@star[1]{%
		\@axis@no@star@splitter@#1//\@nil%
	}
	\def\@axis@no@star@splitter@#1//#2\@nil{%
		\ensuremath{\@interval@tool@no@star{(}{#1}{;}{\@axis@comafy@#2\@nil}{)}}%
	}

    \newcommand\@axis@star[1]{%
		\@axis@star@splitter@#1//\@nil%
	}
	\def\@axis@star@splitter@#1//#2\@nil{%
		\ensuremath{\@interval@tool@star{(}{#1}{;}{\@axis@comafy@#2\@nil}{)}}%
	}

% Geometric points for naming some axes
	\def\@axis@comafy@gptify@#1//#2\@nil{%
		\@ifmtarg{#2}{%
			\gpt{#1}%
		}{%
			\gpt{#1} , \@axis@comafy@gptify@#2\@nil%
		}%
	}

    \newcommand\gpaxis[1]{%
		\@gpaxis@splitter@#1//\@nil%
	}
	\def\@gpaxis@splitter@#1//#2\@nil{%
		\ensuremath{\@interval@tool@no@star{(}{\gpt{#1}}{;}{\@axis@comafy@gptify@#2\@nil}{)}}%
	}

% Vectors for naming some axes
	\def\@axis@comafy@vectify@#1//#2\@nil{%
		\@ifmtarg{#2}{%
			\vect{\trim@spaces{#1}}%
		}{%
			\vect{\trim@spaces{#1}} , \@axis@comafy@vectify@#2\@nil%
		}%
	}

    \newcommand\vaxis[1]{%
		\@vaxis@splitter@#1//\@nil%
	}
	\def\@vaxis@splitter@#1//#2\@nil{%
		\ensuremath{\@interval@tool@no@star{(}{#1}{;}{\@axis@comafy@vectify@#2\@nil}{)}}%
	}

% Geometric points and vectors for naming some axes
    \newcommand\gpvaxis[1]{%
		\@gpvaxis@splitter@#1//\@nil%
	}
	\def\@gpvaxis@splitter@#1//#2\@nil{%
		\ensuremath{\@interval@tool@no@star{(}{\gpt{#1}}{;}{\@axis@comafy@vectify@#2\@nil}{)}}%
	}



\begin{document}

% \section{Geometry}
%
    \subsection{Naming axes}

            \paragraph{Example of use \#1}

\begin{tcblisting}{}
In a plane, three points $\gpt{O}$, $\gpt{I}$ and $\gpt{J}$ not aligned define
a cartesian system of coordinates $\axis{\gpt{O} // \gpt{I} // \gpt{J}}$.

% We will give more efficient ways to name axies in some particular cases.
\end{tcblisting}


            \paragraph{Example of use \#2}

\begin{tcblisting}{}
$\displaystyle \axis{\gpt{O} // \frac{7}{3} \vect{i} // \vect{j}}$
or
$\displaystyle \axis*{\gpt{O} // \frac{7}{3} \vect{i} // \vect{j}}$
\end{tcblisting}


            \paragraph{Example of use \#3}

\begin{tcblisting}{}
% You must at least use two "pieces" separated by //, but there is no maximum !

$\axis{\gpt{O} // \vect*{i}{1} // \vect*{i}{2} // \vect*{i}{3} // \dots
// \vect*{i}{9}// \vect*{i}{10}}$
\end{tcblisting}


            \paragraph{Example of use \#4 - No star version here}

\begin{tcblisting}{}
$\gpaxis{O // I // J // K}$ is just the same than
$\axis{\gpt{O} // \gpt{I} // \gpt{J} // \gpt{K}}$.

% The prefix "gp" is for "geometric point".
\end{tcblisting}


            \paragraph{Example of use \#5 - No star version here}

\begin{tcblisting}{}
$\vaxis{\gpt{O} // i // j}$ is just the same than
$\axis{\gpt{O} // \vect{i} // \vect{j}}$.

% The prefix "v" is for "vector".
\end{tcblisting}


            \paragraph{Example of use \#6 - No star version here}

\begin{tcblisting}{}
$\gpvaxis{O // i // j}$ is just the same than
$\axis{\gpt{O} // \vect{i} // \vect{j}}$.

% The prefix "gpv" adds the features of the prefixes "gp" and "v".
\end{tcblisting}



            \paragraph{Technical IDs}

\IDmacro*{axis}{1}

\IDmacro*{axis*}{1}

\IDarg{} the argument is made of formulas separated by \verb+//+ with the following meanings.

\begin{itemize}[topsep=0pt]
	\item The first one is the origin of the cartesian system of coordinates.
	
	\item Then there are points or vectors which "define" each axis.
\end{itemize}


\bigskip

\IDmacro*{gpaxis}{1} where \verb+gp = G-eometric P-oint+

\IDarg{} the argument is made of formulas separated by \verb+//+ with the following meanings.

\begin{itemize}[topsep=0pt]
	\item The first one is the origin of the cartesian system of coordinates on which the macro \verb+\gpt+ will be automatically applied.
	
	\item Then there are points which "define" each axis, and on each of this points the macro \verb+\gpt+ will be automatically applied.
\end{itemize}


\bigskip

\IDmacro*{vaxis}{1} where \verb+v = V-ector+

\IDarg{} the argument is made of formulas separated by \verb+//+ with the following meanings.

\begin{itemize}[topsep=0pt]
	\item The first one is the origin of the cartesian system of coordinates.
	
	\item Then there are vectors which "define" each axis, and on each of this vectors the macro \verb+\vect+ will be automatically applied.
\end{itemize}


\bigskip

\IDmacro*{gpvaxis}{3} where \verb&gpv = gp + v&

\IDarg{} the argument is made of formulas separated by \verb+//+ with the following meanings.

\begin{itemize}[topsep=0pt]
	\item The first one is the origin of the cartesian system of coordinates on which the macro \verb+\vect+ will be automatically applied.
	
	\item Then there are vectors which "define" each axis, and on each of this vectors the macro \verb+\vect+ will be automatically applied.
\end{itemize}

\end{document}
